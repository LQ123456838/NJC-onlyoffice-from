<!--
 (c) Copyright Ascensio System SIA 2020

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 -->
<!DOCTYPE html>
<html lang="en">

<head>
    <title>ProPact</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="text/javascript" src="https://onlyoffice.github.io/sdkjs-plugins/v1/plugins.js"></script>
    <script type="text/javascript" src="https://onlyoffice.github.io/sdkjs-plugins/v1/plugins-ui.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
            crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link rel="stylesheet" href="styles/font-awesome.min.css">
    <link rel="stylesheet" href="styles/style.css">
    <script src="vendor/jQuery-2.2.2-min/jquery-v2.2.2-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js"></script>
    <script type="text/javascript" src="scripts/code.js"></script>
</head>
<body>
<div class="left-sidebar">
    <div class="invite-counterpartie d-none" id="divInviteCounterparty">
        <a href="#" class="invite-button" id="btnRedirectInviteCounterpartyForm">
            <img src="images/plus.svg" alt="plus">
            Invite Counterparty
        </a>
    </div>
    <div class="invite-counterpartie-form d-none" id="divInviteCounterpartyForm">
        <div class="invite-form">
            <div class="invite-form-header">
                <h3>Invite Counterparties</h3>
                <!--<a href="#" class="close-btn" id="btnRedirectInviteCounterparty">
                    <img src="images/close.svg" alt="Close Icon">
                </a>-->
            </div>
            <div class="form-inner">
                <form id="inviteForm" method="get" action>
                    <div class="form-group">
                        <label class="">First name</label>
                        <input type="text" class="form-control" placeholder="First name" name="firstName" required>
                    </div>
                    <div class="form-group">
                        <label class="">Last Name</label>
                        <input type="text" class="form-control" placeholder="Last name" name="lastName" required>
                    </div>
                    <div class="form-group">
                        <label class="">Email</label>
                        <input type="email" class="form-control" placeholder="Email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label class="">Organisation name</label>
                        <input type="text" class="form-control" placeholder="Organisation name" name="organisationName"
                               required>
                    </div>

                    <div class="submit-btn">
                        <a class="btn btn-secondary" href="#" id="btnRedirectInviteCounterpartyCancel">Cancel</a>
                        <!--                    <a class="btn btn-primary" href="#" id="btnRedirectInviteCounterpartySubmit">Invite</a>-->
                        <button class="btn btn-primary" type="submit">Invite</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="invite-counterpartie-pending d-none" id="divInviteCounterpartyPending">
        <div class="invite-form">
            <div class="invite-form-header">
                <h3>Invite Counterparties</h3>
                <a href="#" class="close-btn"><img src="images/close.svg" alt="Close Icon"> </a>
            </div>
            <div class="contract-section disabled" id="contractCounterpartySection">
                <div class="intellivision-inner">
                    <img id="organizationImage" src="images/org-placeholder.png" alt="Organization">
                    <h4 id="organizationName">Organization</h4>
                </div>
                <div class="contract-user-list">
                    <div class="contract-user-inner">
                        <div class="contract-user-icon">
                            <img id="counterpartyImage" src="images/no-profile-image.jpg" alt="Rio Mendoza">
                        </div>
                        <div class="contract-user-name">
                            <h4 id="counterpartyName">Counterparty User</h4>
                            <span id="counterpartyRole">Counterparty</span>
                        </div>
                    </div>
                    <p id="invitationActionPara"><a href="#" id="btnResendVerification">Click here</a> to resend
                        invitation OR <a href="#" id="btnCancelInvitation">Cancel</a></p>
                </div>
            </div>
        </div>
    </div>
    <div class="contract-lists d-none" id="divContractLists">
        <div class="contract-drafting">
            <div class="contract-header">
                <a href="#" id="btnMarkupMode" class="btn btn-markup">Markup Mode</a>
                <a href="#" class="btn btn-primary" id="btnCreateClause" style="color: #fff !important;">Create
                    Clause</a>
            </div>
            <div class="contract-list">
                <div class="contract-search">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search">
                        <button class="btn"><img src="images/icon-search.svg" alt="Icon Search"></button>
                    </div>
                </div>
                <div class="contract-list-items">
                    <div class="contract-item">
                        <a href="#">
                            <div class="contract-top">
                                <h3>Clause 1.2</h3>
                                <p>In publishing and graphic design, lorem ipsum is a placeholder text commonly used to
                                    demonstrate the visual...</p>
                                <button class="btn brown-color">Under Negotiation</button>
                            </div>
                            <div class="contract-foot">
                                <div class="contract-foot-inner">
                                    <div class="contract-foot-item">
                                        <h3>Created by</h3>
                                        <div class="contract-user">
                                            <img src="images/user-icon.png" alt="">
                                            <span>Me</span>
                                        </div>
                                    </div>
                                    <div class="contract-foot-item">
                                        <h3>Requires action by</h3>
                                        <div class="contract-user">
                                            <img src="images/user-icon2.png" alt="">
                                            <span>Kathryn Jackson</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </a>
                    </div>
                    <div class="contract-item">
                        <a href="#">
                            <div class="contract-top">
                                <h3>Clause 2.4</h3>
                                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
                                    incididunt ut labore et dolore magna...</p>
                                <button class="btn fuchsia-color">Drafting</button>
                            </div>
                            <div class="contract-foot">
                                <div class="contract-foot-inner">
                                    <div class="contract-foot-item">
                                        <h3>Created by</h3>
                                        <div class="contract-user">
                                            <img src="images/user-icon.png" alt="">
                                            <span>Frank Schneider</span>
                                        </div>
                                    </div>
                                    <div class="contract-foot-item">
                                        <h3>Requires action by</h3>
                                        <div class="contract-user">
                                            <img src="images/user-icon2.png" alt="">
                                            <span>Me</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </a>
                    </div>
                    <div class="contract-item">
                        <a href="#">
                            <div class="contract-top">
                                <h3>Clause 3.0</h3>
                                <p>In publishing and graphic design, lorem ipsum is a placeholder text commonly used to
                                    demonstrate the visual...</p>
                                <button class="btn fuchsia-color">Drafting</button>
                            </div>
                            <div class="contract-foot">
                                <div class="contract-foot-inner">
                                    <div class="contract-foot-item">
                                        <h3>Created by</h3>
                                        <div class="contract-user">
                                            <img src="images/user-icon.png" alt="">
                                            <span>Amanda Roberts</span>
                                        </div>
                                    </div>
                                    <div class="contract-foot-item">
                                        <h3>Requires action by</h3>
                                        <div class="contract-user">
                                            <img src="images/user-icon2.png" alt="">
                                            <span>Me</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </a>
                    </div>
                    <div class="contract-item">
                        <a href="#">
                            <div class="contract-top">
                                <h3>Clause 4</h3>
                                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
                                    incididunt ut labore et dolore magna...</p>
                                <button class="btn success-color">Completed</button>
                            </div>
                            <div class="contract-foot">
                                <div class="contract-foot-inner">
                                    <div class="contract-foot-item">
                                        <h3>Created by</h3>
                                        <div class="contract-user">
                                            <img src="images/user-icon.png" alt="">
                                            <span>Me</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="contract-create-form d-none" id="divContractCreate">
        <div class="create-contract">
            <div class="create-contract-header">
                <div class="conversation-left">
                    <span class="user-icon" id="userProfileImage">
                        <img src="images/profile-image.png" alt="">
                    </span>
                    <div class="user-inner">
                        <span class="user-name" id="userProfileName">Jane Nelson</span>
                        <p id="userProfilerole">Lawyer</p>
                    </div>
                </div>
                <a href="#" class="close-btn" id="btnContractCreateClose">
                    <img src="images/close.svg" alt="Close Icon">
                </a>
            </div>
            <div class="create-contract-inner">
                <form id="clauseForm" method="get" action>
                    <div class="form-group">
                        <label class="">Clause</label>
                        <input type="text" class="form-control" placeholder="Clause" name="contractSection" required>
                    </div>
                    <div class="form-group">
                        <label class="">Clause Description</label>
                        <textarea class="form-control" name="contractDescription"
                                  placeholder="Clause Description" required></textarea>
                    </div>
                    <div class="form-group">
                        <label class="">Invite Users</label>
                        <input (click)="showHideFilterOptions(!isFilterOptionToggle,$event)"
                               type="text" class="form-control invite-users-input"
                               placeholder="Select users and teams">
                        <div class="filter-box invite-users-box">
                            <div class="accordion" id="accordionExample">
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button"
                                                data-bs-toggle="collapse" data-bs-target="#collapseTeams"
                                                aria-expanded="false" aria-controls="collapseTeams">
                                            <input type="checkbox" id="inviteteams" class="form-check-input d-none">
                                            Teams
                                        </button>
                                    </h2>
                                    <div id="collapseTeams" class="accordion-collapse collapse"
                                         data-bs-parent="#accordionExample">
                                        <div class="accordion-body" id="accordionBodyTeams">
                                            <p id="teamsNoteFoundMessage">
                                                There are no teams to select. You need to add Teams from the contract
                                                dashboard first.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button"
                                                data-bs-toggle="collapse" data-bs-target="#collapseUsers"
                                                aria-expanded="false" aria-controls="collapseUsers">
                                            <input type="checkbox" id="inviteusers" class="form-check-input d-none">
                                            Users
                                        </button>
                                    </h2>
                                    <div id="collapseUsers" class="accordion-collapse collapse"
                                         data-bs-parent="#accordionExample">
                                        <div class="accordion-body" id="accordionBodyUsers">
                                            <p id="usersNoteFoundMessage">
                                                There are no users to select. You need to add them from the contract
                                                dashboard first.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <select class="form-control d-none">
                            <option value="volvo">Select users and teams</option>
                            <option value="saab">Saab</option>
                            <option value="fiat">Fiat</option>
                            <option value="audi">Audi</option>
                        </select>
                    </div>
                    <div class="submit-btn">
                        <a class="btn btn-secondary" href="#" id="btnContractCreateCancel"
                           style="color: #445799 !important">Cancel</a>
                        <!--                        <a class="btn btn-primary" href="#" id="btnRedirectClauseLists" style="color: #fff !important;">Review Clause</a>-->
                        <button class="btn btn-primary" type="submit">Review Clause</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="contract-chat-history d-none" id="divContractChatHistory">
        <div class="meeting-screen">
            <div class="chat-create-header">
                <h3>View the Conversion History</h3>
                <a href="#" class="close-btn" id="btnRedirectClauseListsA">
                    <img src="images/close.svg" alt="Close Icon">
                </a>
            </div>
            <div class="chat-body">
                <div class="chat-area">
                    <div class="top-bar">
                        <span>Today</span>
                    </div>
                    <div class="message-wrapper reverse">
                        <div class="profile-picture">
                            <p class="last-seen">11:44 am</p>
                            <p class="name">Jane Nelson</p>
                            <img src="images/profile-image.png" alt="pp">
                        </div>
                        <div class="message-content">
                            <div class="message">Hi guys <br> Please review this clause and let me <br> know your
                                thoughts. <br> I’m concerned about the “terms and <br> conditions.
                            </div>
                        </div>
                    </div>
                    <div class="message-wrapper reverse d-none">
                        <div class="profile-picture">
                            <p class="last-seen">10:39 am</p>
                            <p class="name">Bob Miller</p>
                            <img src="images/linkedin-sales.png" alt="pp">
                        </div>
                        <div class="message-content">
                            <div class="message">Hi @Jane Nelson <br>Yep, that's concerning for us too. <br> Nothing
                                will be "reasonably <br> acceptable" to these guys. We need <br> to make it cleaner than
                                that. How <br> about we get them to agree to all <br> assignment terms as we go. There
                                <br> are only 6 contracts to which this <br> will apply anyway
                            </div>
                        </div>
                    </div>
                    <div class="message-wrapper reverse d-none">
                        <div class="profile-picture">
                            <p class="last-seen">10:52 am</p>
                            <p class="name">Bill Andrews</p>
                            <img src="images/linkedin-sales1.png" alt="pp">
                        </div>
                        <div class="message-content">
                            <div class="message">Hi @Jane Nelson <br>Yep, that's concerning for us too. <br> Nothing
                                will be "reasonably <br> acceptable" to these guys. We need <br> to make it cleaner than
                                that. How <br> about we get them to agree to all <br> assignment terms as we go. There
                                <br> are only 6 contracts to which this <br> will apply anyway
                            </div>
                        </div>
                    </div>
                    <div class="message-wrapper dark-gold-color d-none">
                        <div class="profile-picture">
                            <img src="images/profile-image.png" alt="pp">
                            <p class="name">Jane Nelson</p>
                            <p class="last-seen">11:00am</p>
                        </div>
                        <div class="message-content">
                            <h4>Sent a position confirmation <br> request</h4>
                            <div class="message">Proposal Change to sub (b) so <br> assignment terms must be <br>
                                approved by Buyer in 14 days or <br> they will be deemed to be <br> approved.
                            </div>
                        </div>
                    </div>
                    <div class="message-wrapper light-gold-color d-none">
                        <div class="profile-picture">
                            <img src="images/linkedin-sales3.png" alt="pp">
                            <p class="name">Rio Mendoza</p>
                            <p class="last-seen">10:05 am</p>
                        </div>
                        <div class="message-content">
                            <div class="message">We have got this proposal on sub <br> (b) clause 10.1 from the Seller.
                                In my <br> view it is ok but it should be 28 days <br> not 14 and instead of “reasonable
                                <br> endeavours” it should be “best <br> endeavours”. Your thoughts?
                            </div>
                        </div>
                    </div>
                    <div class="message-wrapper reverse dudhiya-color d-none">
                        <div class="profile-picture">
                            <p class="last-seen">10:39 am</p>
                            <p class="name">Bob Miller</p>
                            <img src="images/linkedin-sales.png" alt="pp">
                        </div>
                        <div class="message-content">
                            <h4>Sent a position confirmation <br> request</h4>
                            <div class="message">Proposal Change to sub (b) so <br> assignment terms must be <br>
                                approved by Buyer in 14 days or <br> they will be deemed to be <br> approved.
                            </div>
                        </div>
                        <strong>Position Approved By Bob Miller</strong>
                    </div>
                    <div class="message-wrapper reverse">
                        <div class="profile-picture">
                            <p class="last-seen">10:39 am</p>
                            <p class="name">Bob Miller</p>
                            <img src="images/linkedin-sales.png" alt="pp">
                        </div>
                        <div class="message-content">
                            <div class="message">Hi @Bob Miller, They have rejected <br> our proposal and send an
                                counter <br> proposal with condition "Proposal <br> agree to change to sub (b) as <br>
                                proposed above but with <br> “reasonable endeavours” becoming <br> “best endeavours”".
                                What is your <br> thoughts on this?
                            </div>
                        </div>
                    </div>
                    <div class="message-wrapper red-color">
                        <div class="profile-picture">
                            <img src="images/profile-image.png" alt="pp">
                            <p class="name">Rio Mendoza</p>
                            <p class="last-seen">11:00am</p>
                        </div>
                        <div class="message-content">
                            <h4>Position confirmation rejected</h4>
                            <div class="message">Proposal Change to sub (b) so <br> assignment terms must be <br>
                                approved by Buyer in 14 days or <br> they will be deemed to be <br> approved.
                            </div>
                        </div>
                        <strong>Position Rejected by Rio Mendoza</strong>
                    </div>
                </div>
            </div>
            <div class="chat-create-footer">
                <div class="chat-footer-inner">
                    <button class="btn" id="btnGoToSameSideChat">Go to same side</button>
                    <button class="btn" id="btnGoToCounterparty">Go to counterparty</button>
                </div>
            </div>
        </div>
    </div>
    <div class="contract-sameside-chat d-none" id="divContractSameSideChat">
        <div class="meeting-screen conversion-history">
            <div class="chat-create-header">
                <div class="conversation-left">
                    <span class="user-icon">
                        <img src="images/profile-image.png" alt="">
                    </span>
                    <div class="user-inner">
                        <span class="user-name">Jane Nelson</span>
                        <p>Lawyer</p>
                    </div>
                </div>
                <div class="conversation-right">
                    <ul>
                        <li>
                            <a href="#">
                                <img src="images/chat-header-icon1.svg" alt="">
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <img src="images/chat-header-icon2.svg" alt="">
                            </a>
                            <div class="invite-user-tabs active">
                                <div class="invite-user-tabs-header">
                                    <ul class="nav nav-tabs" role="tablist">
                                        <li class="nav-item">
                                            <a class="nav-link active" data-bs-toggle="tab" href="#users-tabs">Users</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" data-bs-toggle="tab" href="#user-teams">Teams</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="invite-user-tabs-body">
                                    <div class="tab-content">
                                        <div id="users-tabs" class="tab-pane active">
                                            <div class="invite-user-list">
                                                <ul>
                                                    <li>
                                                        <div class="invite-user-inner">
                                                            <div class="invite-user-icon">
                                                                <img src="images/henderson.png" alt="">
                                                            </div>
                                                            <div class="invite-user-name">
                                                                <h3>Johnny Henderson</h3>
                                                                <span>Legal Adviser</span>
                                                            </div>
                                                        </div>
                                                    </li>
                                                    <li>
                                                        <div class="invite-user-inner">
                                                            <div class="invite-user-icon">
                                                                <img src="images/henderson.png" alt="">
                                                            </div>
                                                            <div class="invite-user-name">
                                                                <h3>Johnny Henderson</h3>
                                                                <span>Legal Adviser</span>
                                                            </div>
                                                        </div>
                                                    </li>
                                                </ul>
                                                <div class="invite-btn">
                                                    <button class="btn btn-primary">
                                                        <img src="images/invite-user-btn-icon.svg "
                                                             alt="invite user btn icon"> Invite
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="user-teams" class="tab-pane">
                                            <div class="user-teams-list">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <a href="#">
                                <img src="images/chat-header-icon3.svg" alt="">
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <img src="images/chat-header-icon4.svg" alt="">
                            </a>
                        </li>

                    </ul>
                    <a href="#" class="close-btn" id="btnRedirectClauseListsB">
                        <img src="images/close.svg" alt="Close Icon">
                    </a>
                </div>
            </div>
            <div class="chat-body">
                <div class="chat-area">
                    <div class="top-bar">
                        <span>Today</span>
                    </div>
                    <div class="message-wrapper reverse">
                        <div class="profile-picture">
                            <p class="last-seen">10:37 am</p>
                            <p class="name">Jane Nelson</p>
                            <img src="images/profile-image.png" alt="pp">
                        </div>
                        <div class="message-content">
                            <div class="message">Hi guys <br>Please review this clause and let me <br>know your
                                thoughts. <br>I’m concerned about the “terms and <br>conditions
                            </div>
                        </div>
                    </div>
                    <div class="message-wrapper grey-color">
                        <div class="profile-picture">
                            <img src="images/linkedin-sales3.png" alt="pp">
                            <p class="name">Bob Miller</p>
                            <p class="last-seen">11:00 am</p>
                        </div>
                        <div class="message-content">
                            <div class="message">Hi <b>@Jane Nelson</b> <br>Yep, that's concerning for us too. <br>Nothing
                                will be "reasonably <br>acceptable" to these guys. We need <br>to make it cleaner than
                                that.
                            </div>
                            <a href="#" class="delete-icon"><img src="images/delete-icon.svg" alt=""></a>
                        </div>
                        <div class="request-row">
                            <div class="request-content">
                                <h4>Sent a position confirmation <br> request</h4>
                                <div class="content-message">
                                    Proposal Change to sub (b) so <br> assignment terms must be <br> approved by Buyer
                                    in 14 days or <br> they will be deemed to be <br> approved.
                                </div>
                            </div>
                            <div class="request-btn">
                                <button class="btn btn-primary">Approve</button>
                                <button class="btn reject-btn">Reject</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="chat-create-footer">
                <div class="form-group">
                    <textarea type="textarea"
                              placeholder="Thanks Bill and Bob. That makes sense. I will propose a change to sub (b) so assignment terms must be approved by Buyer in 14 days..."
                              class="form-control"></textarea>
                </div>
                <div class="chat-footer-inner">
                    <button class="btn" id="btnGoToCounterpartyA">Go to counterparty</button>
                    <div class="send-btn">
                        <button class="btn-primary attach"><img src="images/attach-icon.svg" alt=""></button>
                        <button class="btn-primary"><img src="images/send-icon.svg" alt=""> Send</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<script>
    $(document).ready(function () {
// Plugin Code - Start CM //
        var displayNoneClass = "d-none";
        var disabledClass = "disabled";
        var authToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2NDEyYTNmODkzMWMyMTJkM2VkMDE3ZWEiLCJmaXJzdE5hbWUiOiJNaWxhbiIsImxhc3ROYW1lIjoiSGlycGFyYSIsImVtYWlsIjoibWlsYW4uZW5jb2RlZG90c0BnbWFpbC5jb20iLCJyZXF1ZXN0RnJvbSI6InVzZXIiLCJpYXQiOjE2ODgzMDAxMzEsImV4cCI6MTY5MDg5MjEzMX0.9tr0tD7YOD6j9t_syja77IlLux2eqUzZCORG_PM57lo';
        var documentID = '64b40a6f7d52a8cfbcbf524e';
        var loggedInUserID = '';
        var apiBaseUrl = 'http://localhost:3000/api/v1/app';
        var IMAGE_USER_PATH_LINK = 'https://propact.s3.amazonaws.com/'

        // if (text) {
        //     document.getElementById('btnCreateClause').classList.remove(disabledClass);
        // } else {
        //     if (!document.getElementById('btnCreateClause').classList.contains(disabledClass)) {
        //         document.getElementById('btnCreateClause').classList.add(disabledClass);
        //     }
        // }


        // $(document).ready(function () {

        // Get & Set documentID
        // documentID = window.Asc.plugin.info.documentId;
        // Get & Set documentID

        // Get & Set loggedin user ID
        // loggedInUserID = window.Asc.plugin.info.userId;
        // Get & Set loggedin user ID

        // Get & Set AuthToken
        // authToken = window.Asc.plugin.info.documentCallbackUrl.split('/').pop();
        // Get & Set AuthToken

        // Get & Set APIBASEURL
        // apiBaseUrl = url.split('/').slice(0, 6).join('/');
        // Get & Set APIBASEURL

        // Get contract details
        if (documentID && authToken) {
            getOpenContractUserDetails();
        }
        // Get contract details

        // Invite counterparty screen
        const varBtnRedirectInviteCounterpartyForm = document.getElementById('btnRedirectInviteCounterpartyForm');
        varBtnRedirectInviteCounterpartyForm.addEventListener('click', function () {
            document.getElementById('divInviteCounterparty').classList.add(displayNoneClass);
            document.getElementById('divInviteCounterpartyForm').classList.remove(displayNoneClass);
        });
        // Invite counterparty screen

        // Invite counterparty Form screen
        const varBtnRedirectInviteCounterpartyCancel = document.getElementById('btnRedirectInviteCounterpartyCancel');
        varBtnRedirectInviteCounterpartyCancel.addEventListener('click', function () {
            document.getElementById('divInviteCounterparty').classList.remove(displayNoneClass);
            document.getElementById('divInviteCounterpartyForm').classList.add(displayNoneClass);
        });
        // Invite counterparty Form screen

        // Invite counterparty Pending screen
        const varBtnResendVerification = document.getElementById('btnResendVerification');
        varBtnResendVerification.addEventListener('click', function () {
            resendCounterpartyInvitation();
        });

        const varBtnCancelInvitation = document.getElementById('btnCancelInvitation');
        varBtnCancelInvitation.addEventListener('click', function () {
            cancelInvitation();
        });
        // Invite counterparty Pending screen

        // Contract clause lists screen
        const varBtnCreateClause = document.getElementById('btnCreateClause');
        varBtnCreateClause.addEventListener('click', function () {
            // if (text) {
            document.getElementById('divContractLists').classList.add(displayNoneClass);
            document.getElementById('divContractCreate').classList.remove(displayNoneClass);
            // var nContentControlType = 2;
            // color = {
            //     R: 104,
            //     G: 215,
            //     B: 248,
            // };
            // window.Asc.plugin.executeMethod("AddContentControl", [nContentControlType, {
            //     "Id": 7,
            //     "Tag": text.replace(/\n/g, "<br>"),
            //     "Lock": 0,
            //     "Color": color
            // }]);
            // }
        });

        const buttonsOpenChatBoard = document.querySelectorAll('.contract-item');
        // Add a click event listener to each button element
        buttonsOpenChatBoard.forEach(function (button) {
            button.addEventListener('click', function () {
                document.getElementById('divContractLists').classList.add(displayNoneClass);
                document.getElementById('divContractChatHistory').classList.remove(displayNoneClass);
            });
        });
        // Contract clause lists screen

        // Create contract clause screen
        const varBtnContractCreateClose = document.getElementById('btnContractCreateClose');
        varBtnContractCreateClose.addEventListener('click', function () {
            document.getElementById('divContractLists').classList.remove(displayNoneClass);
            document.getElementById('divContractCreate').classList.add(displayNoneClass);
        });

        const varBtnContractCreateCancel = document.getElementById('btnContractCreateCancel');
        varBtnContractCreateCancel.addEventListener('click', function () {
            document.getElementById('divContractLists').classList.remove(displayNoneClass);
            document.getElementById('divContractCreate').classList.add(displayNoneClass);
        });

        /*const varBtnRedirectClauseLists = document.getElementById('btnRedirectClauseLists');
        varBtnRedirectClauseLists.addEventListener('click', function () {
            document.getElementById('divContractCreate').classList.add(displayNoneClass);
            document.getElementById('divContractChatHistory').classList.remove(displayNoneClass);
        });*/
        // Create contract clause screen

        // Contract chat history screen
        const varBtnRedirectClauseListsA = document.getElementById('btnRedirectClauseListsA');
        varBtnRedirectClauseListsA.addEventListener('click', function () {
            document.getElementById('divContractLists').classList.remove(displayNoneClass);
            document.getElementById('divContractChatHistory').classList.add(displayNoneClass);
        });

        const varBtnGoToSameSideChat = document.getElementById('btnGoToSameSideChat');
        varBtnGoToSameSideChat.addEventListener('click', function () {
            document.getElementById('divContractSameSideChat').classList.remove(displayNoneClass);
            document.getElementById('divContractChatHistory').classList.add(displayNoneClass);
        });

        const varBtnGoToCounterparty = document.getElementById('btnGoToCounterparty');
        varBtnGoToCounterparty.addEventListener('click', function () {
            document.getElementById('divContractSameSideChat').classList.remove(displayNoneClass);
            document.getElementById('divContractChatHistory').classList.add(displayNoneClass);
        });
        // Contract chat history screen

        // Contract sameside chat screen
        const varBtnGoToCounterpartyA = document.getElementById('btnGoToCounterpartyA');
        varBtnGoToCounterpartyA.addEventListener('click', function () {
            document.getElementById('divContractSameSideChat').classList.remove(displayNoneClass);
            document.getElementById('divContractChatHistory').classList.add(displayNoneClass);
        });

        const varBtnRedirectClauseListsB = document.getElementById('btnRedirectClauseListsB');
        varBtnRedirectClauseListsB.addEventListener('click', function () {
            document.getElementById('divContractLists').classList.remove(displayNoneClass);
            document.getElementById('divContractSameSideChat').classList.add(displayNoneClass);
        });
        // Contract sameside chat screen

        $("#inviteForm").validate({
            submitHandler: function (form) {
                // $(form).ajaxSubmit();
                inviteCounterparties();
            }
        });

        $("#clauseForm").validate({
            submitHandler: function (form) {
                console.log('form', form);
            }
        })

        // });

        /**
         * Get contract user details when plugin init
         */
        function getOpenContractUserDetails() {
            const getContractUserDetailsUrl = apiBaseUrl + '/contract/getOpenContractUserDetails/' + documentID;
            const headers = {
                'Content-Type': 'application/json',
                'Authorization': 'Bearer ' + authToken
            };
            const requestOptions = {
                method: 'GET',
                headers: headers,
            };
            fetch(getContractUserDetailsUrl, requestOptions)
                .then(response => response.json())
                .then(data => {
                    // Handle the response data
                    const responseData = data;
                    if (responseData && responseData.status == true && responseData.code == 200) {
                        if (responseData.data.invitationDetail && responseData.data.invitationDetail._id) {
                            document.getElementById('divInviteCounterparty').classList.add(displayNoneClass);
                            document.getElementById('divInviteCounterpartyPending').classList.remove(displayNoneClass);
                            document.getElementById('organizationName').textContent = responseData.data.invitationDetail.organizationName;
                            document.getElementById('counterpartyName').textContent = responseData.data.invitationDetail.firstName + " " + responseData.data.invitationDetail.lastName;
                        } else if (responseData.data.oppositeUser && responseData.data.oppositeUser._id) {
                            document.getElementById('divInviteCounterpartyPending').classList.add(displayNoneClass);
                            document.getElementById('divInviteCounterparty').classList.add(displayNoneClass);
                            document.getElementById('invitationActionPara').classList.add(displayNoneClass);
                            document.getElementById('divContractLists').classList.remove(displayNoneClass);
                            document.getElementById('contractCounterpartySection').classList.remove(disabledClass);
                            document.getElementById('userProfileImage').src = responseData.data.loggedInUserDetails.imageUrl;
                            document.getElementById('counterpartyImage').src = responseData.data.oppositeUser.imageUrl;
                            document.getElementById('organizationImage').src = responseData.data.oppositeUser.company.imageUrl;
                            document.getElementById('userProfileName').textContent = responseData.data.loggedInUserDetails.firstName + " " + responseData.data.loggedInUserDetails.lastName;
                            document.getElementById('userProfilerole').textContent = responseData.data.loggedInUserDetails.role;
                            document.getElementById('organizationName').textContent = responseData.data.oppositeUser.company.companyName;
                            document.getElementById('counterpartyName').textContent = responseData.data.oppositeUser.firstName + " " + responseData.data.oppositeUser.lastName;
                            getContractTeamAndUserList();
                        } else if ((responseData.data.openContractDetails && responseData.data.openContractDetails.counterPartyInviteStatus && responseData.data.openContractDetails.counterPartyInviteStatus == 'Pending') || responseData.data.counterPartyInviteStatus == 'Pending') {
                            document.getElementById('divInviteCounterparty').classList.remove(displayNoneClass);
                        }
                    }
                })
                .catch(error => {
                    // Handle any errors
                    console.error('Error:', error);
                });
        }

        /**
         * Get Contract Team And User List
         */
        function getContractTeamAndUserList() {
            const getContractTeamAndUserListUrl = apiBaseUrl + '/meeting/getContractTeamAndUserList/' + documentID;
            const headers = {
                'Content-Type': 'application/json',
                'Authorization': 'Bearer ' + authToken
            };
            const requestOptions = {
                method: 'GET',
                headers: headers,
            };
            fetch(getContractTeamAndUserListUrl, requestOptions)
                .then(response => response.json())
                .then(data => {
                    // Handle the response data
                    const responseData = data;
                    console.log('responseData', responseData);
                    if (responseData && responseData.data) {
                        var teamLists = responseData.data.filter((ele) => {
                            return ele.type == "team";
                        });
                        var userLists = responseData.data.filter((ele) => {
                            return ele.type == "user" && ele.role !== "Contract Creator";
                        });
                        if (teamLists.length > 0) {
                            document.getElementById('teamsNoteFoundMessage').classList.add(displayNoneClass);
                            document.getElementById('inviteteams').classList.remove(displayNoneClass);
                            var html = '';
                            html += '<div class="filter-inner">\n';
                            html += '<ul>\n';
                            teamLists.forEach((ele) => {
                                html += '<li>\n' +
                                        '<div class="form-check" data-id="'+ele.itemId+'">\n' +
                                            '<input type="checkbox" id="inviteteam_'+ele.itemId+'" class="form-check-input team-chkbox" />' +
                                            '<label for="inviteteam_'+ele.itemId+'" class="form-check-label">\n' +
                                                '<div class="invite-users-inner-bar">\n' +
                                                    '<div class="invite-users-name">\n' +
                                                    '<strong>' + ele.itemName + '</strong>\n' +
                                                    '</div>\n' +
                                                '</div>\n' +
                                            '</label>\n' +
                                        '</div>\n' +
                                    '</li>\n';
                            });
                            html += '</ul>\n';
                            html += '</div>';
                            //accordionBodyTeams
                            document.getElementById('accordionBodyTeams').innerHTML = html;
                        }
                        if (userLists.length > 0) {
                            document.getElementById('usersNoteFoundMessage').classList.add(displayNoneClass);
                            document.getElementById('inviteusers').classList.remove(displayNoneClass);
                            var html = '';
                            html += '<div class="filter-inner">';
                            html += '<ul>';
                            // ' + IMAGE_USER_PATH_LINK + ele.userImage + '
                            // assets/images/no-profile-image.jpg
                            userLists.forEach((ele) => {
                                html += '<li>';
                                html += '<div class="form-check" data-id="'+ele.itemId+'">\n' +
                                    '\t<input type="checkbox" id="inviteuser_'+ele.itemId+'" class="form-check-input user-chkbox" value="'+ele.itemId+'">\n' +
                                    '\t<label for="inviteuser_'+ele.itemId+'" class="form-check-label">\n' +
                                    '\t\t<div class="conversation-left">\n' +
                                    '\t\t\t<span class="user-icon" id="userProfileImage">\n' +
                                    '\t\t\t\t<img src="'+(ele.userImage ? IMAGE_USER_PATH_LINK + ele.userImage : 'images/no-profile-image.jpg')+'" alt="">\n' +
                                    '\t\t\t</span>\n' +
                                    '\t\t\t<div class="user-inner">\n' +
                                    '\t\t\t\t<span class="user-name" id="userProfileName">' + ele.itemName + '</span>\n' +
                                    '\t\t\t\t<p id="userProfilerole">'+ele.role+'</p>\n' +
                                    '\t\t\t</div>\n' +
                                    '\t\t</div>\n' +
                                    '\t</label>\n' +
                                    '</div>';
                                html += '</li>';
                            });
                            html += '</ul>';
                            html += '</div>';
                            document.getElementById('accordionBodyUsers').innerHTML = html;
                        }
                    }
                })
                .catch(error => {
                    // Handle any errors
                    console.error('Error:', error);
                });
        }

        /**
         * Invite counterparties
         */
        function inviteCounterparties() {
            var form = document.getElementById('inviteForm');
            var data = JSON.stringify({
                firstName: form.elements['firstName'].value,
                lastName: form.elements['lastName'].value,
                email: form.elements['email'].value,
                organizationName: form.elements['organisationName'].value
            });
            const inviteCounterpartiesUrl = apiBaseUrl + '/contract/inviteCounterPartyUser/' + documentID;
            const headers = {
                'Content-Type': 'application/json',
                'Authorization': 'Bearer ' + authToken
            };
            const requestOptions = {
                method: 'POST',
                headers: headers,
                body: data
            };
            fetch(inviteCounterpartiesUrl, requestOptions)
                .then(response => response.json())
                .then(data => {
                    // Handle the response data
                    document.getElementById("inviteForm").reset();
                    const responseData = data;
                    if (responseData && responseData.status == true && responseData.code == 200) {
                        document.getElementById('divInviteCounterpartyPending').classList.remove(displayNoneClass);
                        document.getElementById('divInviteCounterpartyForm').classList.add(displayNoneClass);
                        if (responseData.data && responseData.data._id) {
                            document.getElementById('organizationName').textContent = responseData.data.organizationName;
                            document.getElementById('counterpartyName').textContent = responseData.data.firstName + " " + responseData.data.lastName;
                        } else {
                            getOpenContractUserDetails();
                        }
                    }
                })
                .catch(error => {
                    // Handle any errors
                    console.error('Error:', error);
                });
        }

        /**
         * Cancel Invitation
         */
        function cancelInvitation() {
            const cancelInvitationsUrl = apiBaseUrl + '/contract/cancelInvitationEmail/' + documentID;
            const headers = {
                'Content-Type': 'application/json',
                'Authorization': 'Bearer ' + authToken
            };
            const requestOptions = {
                method: 'GET',
                headers: headers,
            };
            fetch(cancelInvitationsUrl, requestOptions)
                .then(response => response.json())
                .then(data => {
                    // Handle the response data
                    console.log(data);
                    const responseData = data;
                    if (responseData && responseData.status == true && responseData.code == 200) {
                        document.getElementById('divInviteCounterpartyPending').classList.add(displayNoneClass);
                        document.getElementById('divInviteCounterparty').classList.remove(displayNoneClass);
                    } else {

                    }
                })
                .catch(error => {
                    // Handle any errors
                    console.error('Error:', error);
                });
        }

        /**
         * Resend counterparty invitation
         */
        function resendCounterpartyInvitation() {
            const resendCounterpartyInvitationUrl = apiBaseUrl + '/contract/resendInvitationEmail/' + documentID;
            const headers = {
                'Content-Type': 'application/json',
                'Authorization': 'Bearer ' + authToken
            };
            const requestOptions = {
                method: 'GET',
                headers: headers,
            };
            fetch(resendCounterpartyInvitationUrl, requestOptions)
                .then(response => response.json())
                .then(data => {
                    // Handle the response data
                    console.log(data);
                    const responseData = data;
                    if (responseData && responseData.status == true && responseData.code == 200) {
                        console.log(responseData.message);
                    }
                })
                .catch(error => {
                    // Handle any errors
                    console.error('Error:', error);
                });
        }

        var selectedInvitedUsers = [];
        var selectedInvitedTeams = [];

        $(document).on('click', '#inviteteams',function () {
            $('.team-chkbox').prop('checked', this.checked);
            updateInviteTeamCheckbox();
        })

        $(document).on('click', '.team-chkbox', function() {
            var allChecked = $('.team-chkbox:checked').length === $('.team-chkbox').length;
            $('#inviteteams').prop('checked', allChecked);
            updateInviteTeamCheckbox();
        });

        $(document).on('click', '#inviteusers',function () {
            $('.user-chkbox').prop('checked', this.checked);
            updateInviteUserCheckbox();
        })

        $(document).on('click', '.user-chkbox', function() {
            var allChecked = $('.user-chkbox:checked').length === $('.user-chkbox').length;
            $('#inviteusers').prop('checked', allChecked);
            updateInviteUserCheckbox();
        });

        function updateInviteTeamCheckbox() {
            console.log('selectedInvitedTeams', selectedInvitedTeams);
            $('.team-chkbox').each(function() {
                let isChecked = $(this).prop("checked");
                let dataID = $(this).parent().data('id');
                if (isChecked) {
                    if (!selectedInvitedTeams.includes(dataID)) {
                        selectedInvitedTeams.push(dataID);
                    }
                } else {
                    if (selectedInvitedTeams.includes(dataID)) {
                        selectedInvitedTeams = $.grep(selectedInvitedTeams, function (value) {
                            return value != dataID;
                        });
                    }
                }
            });
            updateInviteUsersPlacehoder();
            console.log('selectedInvitedTeams', selectedInvitedTeams);
        }

        function updateInviteUserCheckbox() {
            console.log('selectedInvitedUsers', selectedInvitedUsers);
            $('.user-chkbox').each(function() {
                let isChecked = $(this).prop("checked");
                let dataID = $(this).parent().data('id');
                if (isChecked) {
                    console.log('test', selectedInvitedUsers.includes(dataID));
                    if (!selectedInvitedUsers.includes(dataID)) {
                        selectedInvitedUsers.push(dataID);
                    }
                } else {
                    if (selectedInvitedUsers.includes(dataID)) {
                        selectedInvitedUsers = $.grep(selectedInvitedUsers, function (value) {
                            return value != dataID;
                        });
                    }
                }
            });
            updateInviteUsersPlacehoder();
            console.log('selectedInvitedUsers', selectedInvitedUsers);
        }

        function updateInviteUsersPlacehoder() {
            console.log('selectedInvitedTeams', selectedInvitedTeams.length + 'Teams' );
            console.log('selectedInvitedUsers', selectedInvitedUsers.length + 'Users');
        }

        // Plugin Code - End CM //
    });
</script>
</html>