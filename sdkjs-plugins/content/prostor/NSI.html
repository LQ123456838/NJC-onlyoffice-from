<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>ПРОСТОР</title>
    <script type="text/javascript" src="scripts/code.jquery.com_jquery-3.7.0.js"></script>
	<link rel="stylesheet" href="resources/vakata-jstree-8c1bcc8/dist/themes/default/style.min.css" />
    <script src="resources/vakata-jstree-8c1bcc8/dist/jstree.min.js"></script>

</head>
<body>
<div class="item-settings">	
				<label id="lb_url_request">Request URL</label>
				<div style="display: flex;">
					<input id="url_request" type="string" value="http://es-prostor-prch:30000/v2/StationModels/getEntity?entityId=74e0ebd1-d7a9-430d-a366-2a77f603a41f&withProps=true&withRefs=true&hierarchical=true" style="margin-left: 5px;">
				</div>
				<label id="lb_json_path_expr">JSON path Expression</label>
				<div style="display: flex;">
					<input id="json_path_expr" type="string" value="$.[]" style="margin-left: 5px;">
				</div>
</div>
	<h1>Inline data demo</h1>
	<div id="data" class="demo"></div>
  
  <script>
  var myjsonObject = require('./example.json');
//  $.getJSON("./example.json", function(json) {
//    console.log(json); // this will show the info it in firebug console
//	const myjsonObject = json; //some json data. It can have multidimensional values as well
//});
  // Крутой конвертер обычного json в специальный который нужен для дерева
      function jsonToJsTreeObject( json_data_object, final_array = new Array() )
    {
        Object.keys(json_data_object).forEach( function( data ) {
            // console.log("Key:" + data);
            if( Array.isArray(json_data_object[data]) || json_data_object[data] instanceof Object )
            {
                final_array.push( { text: `${data}`, children: jsonToJsTreeObject( json_data_object[data], new Array() ) } );
                // using state attribute 
                // final_array.push( { text: `${data}`, state : {  'opened' : false, 'selected' : false }, children: jsonToJsTreeObject( json_data_object[data], new Array() ) } );
            }
            else
            {
                final_array.push( { text: `${data}`, children: [{ text: `${json_data_object[data]}` }] } );
                // using state attribute
                // final_array.push( { text: `${data}`, state : {  'opened' : false, 'selected' : false }, children: [{ text: `${json_data_object[data]}` }] } );
            }
        });

        return final_array;
    };

console.log(myjsonObject);
	// inline data demo
	$('#data').jstree({
		'core' : {
			'data' : jsonToJsTreeObject( myjsonObject )
		}
	});
	$('#data')
		.on("changed.jstree", function (e, data) {
			if(data.selected.length) {
				console.log('The selected node is: ' + data.instance.get_node(data.selected[0]).text);
			}
		})
		.jstree({
			'core' : {
				'multiple' : false,
				'data' : [
					{ "text" : "Root node", "children" : [
							{ "text" : "Child node 1", "id" : 1 },
							{ "text" : "Child node 2" }
					]}
				]
			}
		});
    </script>
</body>
</html>